<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CERT-IS</title>
    <link rel="stylesheet" href="css/notice-board.css"> 
    <style>
        .banner {
            width: 97%;
            max-width: 2400px;
            aspect-ratio: 30/8;
            background-color: #ddd;
            margin: 30px auto;
            overflow: hidden;
            position: relative;
        }

        .banner img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .banner img.active {
            opacity: 1;
        }

        .container {
            display: flex;
            justify-content: space-between;
        }

        .calendar-container {
            width: 20%;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
        }

        .calendar-header button {
            padding: 5px 10px;
            font-size: 16px;
            background-color: transparent;
            color: black;
            border: none;
            cursor: pointer;
        }

     
        .calendar-header h2 {
            margin: 0;
            font-size: 18px;
        }

        .date-display {
            font-size: 16px;
            color: rgb(0, 0, 0);
            text-align: center;
            background-color: #f0f0f0;
            padding: 6px;
            border: 1px solid #ccc;
            border-bottom: 1px solid #ccc;
        }

        .event-list {
            border: 1px solid #ccc;
            padding: 10px;
            background-color: #f9f9f9;
            height: 150px;
            overflow-y: auto;
        }

        .event {
            background-color: #ffcccb; /* 연붉은색 */
            margin: 2px;
            padding: 2px;
            border-radius: 3px;
        }

        .notice-board {
            width: 60%;
        }
    </style>
</head>
<body>
    <div id="header-placeholder"></div>
    <div class="banner">
        <img src="img/img1.JPG" class="active">
        <img src="img/img2.JPG">
        <img src="img/img3.JPG">
    </div>
    <div class="container">
        <div class="notice-board">
            <div class="notice-board-header">공지사항</div>
            <table>
                <thead>
                    <tr>
                        <th>제목</th>
                        <th>작성자</th>
                        <th>작성일</th>
                    </tr>
                </thead>
                <tbody id="notice-list">
                </tbody>
            </table>
        </div>

        <div class="calendar-container">
            <div class="calendar-header">
                <button id="prevDayInternal">&lt;</button>
                <h2>내부 행사</h2>
                <button id="nextDayInternal">&gt;</button>
            </div>
            <div class="date-display" id="internalDate"></div>
            <div id="internalEvents" class="event-list"></div>
        </div>

        <div class="calendar-container">
            <div class="calendar-header">
                <button id="prevDayExternal">&lt;</button>
                <h2>외부 행사</h2>
                <button id="nextDayExternal">&gt;</button>
            </div>
            <div class="date-display" id="externalDate"></div>
            <div id="externalEvents" class="event-list"></div>
        </div>
    </div>
    
    <script src="js/navi.js"></script>
    <script>
        let currentIndex = 0;
        const images = document.querySelectorAll('.banner img');
        const totalImages = images.length;
        setInterval(() => {
            images[currentIndex].classList.remove('active');
            currentIndex = (currentIndex + 1) % totalImages;
            images[currentIndex].classList.add('active');
        }, 3000);

        loadNotices();
        function loadNotices() { 
            const notices = JSON.parse(localStorage.getItem('boardData')) || [];
            const noticeList = document.getElementById('notice-list');
            const recentNotices = notices.reverse();

            recentNotices.forEach((notice, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${notice.제목}</td>
                    <td>${notice.글쓴이}</td>
                    <td>${notice.작성일}</td>
                `;
                row.addEventListener('click', () => {
                    window.location.href = `detail.html?index=${notices.length - index - 1}`;
                });
                noticeList.appendChild(row);
            });
        }

        // Calendar Event Handling
        let currentInternalDate = new Date();
        let currentExternalDate = new Date();
        const internalEvents = JSON.parse(localStorage.getItem('internalEvents')) || [];
        const externalEvents = JSON.parse(localStorage.getItem('externalEvents')) || [];

        function updateEventList(eventType) {
            const eventList = document.getElementById(`${eventType}Events`);
            const dateDisplay = document.getElementById(`${eventType}Date`);
            const currentDate = eventType === 'internal' ? currentInternalDate : currentExternalDate;
            eventList.innerHTML = '';
            const dateStr = currentDate.toISOString().split('T')[0];

            dateDisplay.textContent = currentDate.toLocaleDateString('ko-KR');

            const events = eventType === 'internal' ? internalEvents : externalEvents;
            const dayEvents = events.filter(event => event.date === dateStr);

            if (dayEvents.length === 0) {
                eventList.innerHTML = '<p>오늘 일정이 없습니다.</p>';
            } else {
                dayEvents.forEach(event => {
                    const eventDiv = document.createElement('div');
                    eventDiv.classList.add('event');
                    eventDiv.textContent = event.title;
                    eventList.appendChild(eventDiv);
                });
            }
        }

        document.getElementById('prevDayInternal').addEventListener('click', function() {
            currentInternalDate.setDate(currentInternalDate.getDate() - 1);
            updateEventList('internal');
        });

        document.getElementById('nextDayInternal').addEventListener('click', function() {
            currentInternalDate.setDate(currentInternalDate.getDate() + 1);
            updateEventList('internal');
        });

        document.getElementById('prevDayExternal').addEventListener('click', function() {
            currentExternalDate.setDate(currentExternalDate.getDate() - 1);
            updateEventList('external');
        });

        document.getElementById('nextDayExternal').addEventListener('click', function() {
            currentExternalDate.setDate(currentExternalDate.getDate() + 1);
            updateEventList('external');
        });

        updateEventList('internal');
        updateEventList('external');
    </script>
</body>
</html>
